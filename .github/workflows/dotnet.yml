name: .NET Core

on: [push]

env:
  CONFIGURATION: Release
  DOTNET_CORE_VERSION: 5.0.x
  CLASS_DIRECTORY: ./code/serviceone
  CLASS_AZURE_WEBAPP_PACKAGE_PATH: ./code/servicetwo/published
  CLAN_DIRECTORY: ./code/servicetwo
  CLAN_AZURE_WEBAPP_PACKAGE_PATH: ./code/servicetwo/published
  FACEOFF_DIRECTORY: ./code/servicethree
  FACEOFF_AZURE_WEBAPP_PACKAGE_PATH: ./code/servicethree/published
  FE_DIRECTORY: ./code/frontend
  FE_AZURE_WEBAPP_PACKAGE_PATH: ./code/frontend/published
  TEST_DIRECTORY: ./code/tests

jobs:
  #build:

   # runs-on: ubuntu-latest

  #  steps:
    #- uses: actions/checkout@v1
    #- name: Setup .NET Core
    #  uses: actions/setup-dotnet@v1
     # with: 
     #   dotnet-version: '5.0.101'
    
    ## dotnet build and publish
    #- name: Build with dotnet
    #  run: dotnet build --configuration Release
    
   # - name: dotnet publish
    #  run: |
     #   dotnet publish -c Release -o dotnetcorewebapp 
    #- name: 'Run Azure webapp deploy action using publish profile credentials'
     # uses: azure/webapps-deploy@v1
     # with: 
     #   app-name: AnimeBattleGenerator # Replace with your app name
      #  publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}
     #   package: './AnimeBattleFrontEnd' 
  build-class-service:
    runs-on: ubuntu-latest
    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: ${{ env.DOTNET_CORE_VERSION }}
      - name: Restore
        run: dotnet restore "${{ env.CLASS_DIRECTORY }}"
      - name: Build
        run: dotnet build "${{ env.CLASS_DIRECTORY }}" --configuration ${{ env.CONFIGURATION }} --no-restore
      - name: Publish
        run: dotnet publish "${{ env.CLASS_DIRECTORY }}" --configuration ${{ env.CONFIGURATION }} --no-build --output "${{ env.CLASS_AZURE_WEBAPP_PACKAGE_PATH }}"
